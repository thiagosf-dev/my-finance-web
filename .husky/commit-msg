#!/usr/bin/env sh

GREEN="\033[0;32m"
YELLOW="\033[1;33m"
RED="\033[0;31m"
CYAN="\033[0;36m"
BOLD="\033[1m"
RESET="\033[0m"

echo ""
printf "${BOLD}${CYAN}⬡ Husky • Commit-msg hook iniciado${RESET}\n"
printf "${YELLOW}→ Validando mensagem de commit com Commitlint (Conventional Commits)...${RESET}\n"
echo ""

npm run commitlint -- --edit "$1"

status=$?

if [ $status -ne 0 ]; then
    echo ""
    printf "${RED}✖ Mensagem de commit inválida.${RESET}\n"
    printf "${RED}   Use o padrão Conventional Commits, por exemplo:${RESET}\n"
    printf "${RED}   - feat(core): implementa novo fluxo de transações${RESET}\n"
    printf "${RED}   - fix(auth): corrige validação de token expirado${RESET}\n"
    printf "${RED}   - chore(config): update .editorconfig${RESET}\n"
    echo ""
    exit $status
fi

echo ""
printf "${GREEN}✔ Mensagem de commit aprovada (Conventional Commits).${RESET}\n"
printf "${CYAN}⬢ Prosseguindo com o commit...${RESET}\n"
echo ""
